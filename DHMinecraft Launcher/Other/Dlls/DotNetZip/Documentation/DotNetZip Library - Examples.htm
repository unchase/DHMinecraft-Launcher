<!DOCTYPE html>
<!-- saved from url=(0080)http://dotnetzip.codeplex.com/wikipage?title=CS-Examples&referringTitle=Examples -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="Chrome" prefix="og: http://ogp.me/ns# profile: http://ogp.me/ns/profile#"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta id="CompatabilityMode" http-equiv="X-UA-Compatible" content="IE=edge">
	    
        <link href="./DotNetZip Library - Examples_files/StyleSheet.ashx" id="MasterCss" rel="stylesheet" type="text/css">
        <link rel="SHORTCUT ICON" href="http://www.codeplex.com/favicon.ico">
        <title>DotNetZip Library - Home</title>
        
        <!--
        Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code,
        not by Microsoft.  See ASP.NET Ajax CDN Terms of Use â€“ http://www.asp.net/ajaxlibrary/CDN.ashx.
        -->
        <script type="text/javascript" src="./DotNetZip Library - Examples_files/ai.js" async=""></script><script src="./DotNetZip Library - Examples_files/jquery-1.4.4.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery === 'undefined') {
                document.write(unescape("%3Cscript src='http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        <script src="./DotNetZip Library - Examples_files/jquery-ui.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery.ui === 'undefined') {
                document.write(unescape("%3Cscript src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        
            <script type="text/javascript">
                var appInsights = { queue: [], start: function (n) { function r(n, t) { n[t] = function () { var i = arguments; n.queue.push(function () { n[t].apply(n, i) }) } } var t, i; this.applicationInsightsId = n; this.accountId = null; this.appUserId = null; r(this, "logEvent"); r(this, "logPageView"); t = document.createElement("script"); t.type = "text/javascript"; t.src = "//az416426.vo.msecnd.net/scripts/ai.js"; t.async = !0; i = document.getElementsByTagName("script")[0]; i.parentNode.insertBefore(t, i) } };
                appInsights.start("f5504185-cb9a-4174-95ba-928e1ac1492c");
                
                appInsights.logPageView();
            </script>
        
    <style type="text/css">.SideBar, .SideBarPadding{display:none;}.MainContent{width:auto;}.SiteContentTable{width:100%;}</style>
    <style id="ProjectStyles" type="text/css">
        .SiteHeader, .SiteHeaderLeft {
            height:45px !important;
            overflow:hidden;
        }
        .SiteContent 
        {
            padding: 0 0 1em 0;
            margin-top:0;
            min-height:225px;
            border-right: 1px solid lightgrey;
            border-left: 1px solid lightgrey;
            border-bottom: 1px solid lightgrey;
        }
        .IE table.MinWidthContent
        {
	        table-layout: auto !important;	
        }
    </style>
    
    
    <style type="text/css">.ProjectContent{padding:0;}</style>
    <style type="text/css">
        .WikiHolder
        {
            margin: 0 1em 0 0;
        }
        #WikiContent
        {
            margin-top: 15px;
        }
        #WikiBreadCrumbs
        {
            margin: 0.25em 0 1em 0;
        }
        .SecondarySearchButton 
        {
            margin:0 0 0 -0.6em;
        }
        .FF .SecondarySearchButton 
        {
            margin:-0.1em 0 0 -0.5em;
            height: 22px;
        }
        .IE .SecondarySearchButton
        {
            width: 22px;
            height: 22px;
        }
    </style>
    
    
    
    
    <meta id="WTProjectName" name="WT.pi" content="DotNetZip">
    

    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://dotnetzip.codeplex.com/rsd">
    <link rel="wlwmanifest" type="application/wlwmanifest+xml" title="WLWManifest" href="http://dotnetzip.codeplex.com/wlwmanifest.xml">
    
    
        <link rel="alternate" type="application/rss+xml" title="DotNetZip Library" url="http://dotnetzip.codeplex.com/project/feeds/rss">
    
        
        <link rel="alternate" type="application/rss+xml" title="DotNetZip Library - Discussions" url="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2fdotnetzip">
        
        <link rel="alternate" type="application/rss+xml" title="DotNetZip Library - Issues" url="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2fdotnetzip">
        
        <link rel="alternate" type="application/rss+xml" title="DotNetZip Library - Downloads" url="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2fdotnetzip">
        <link rel="alternate" type="application/rss+xml" title="DotNetZip Library - Reviews" url="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2fdotnetzip">
        
    
        <link rel="alternate" type="application/rss+xml" title="DotNetZip Library - Source code" url="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2fdotnetzip">
        <link rel="alternate" type="application/rss+xml" title="DotNetZip Library - Wiki" url="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2fdotnetzip">
    
        
    
        <meta content="summary" name="twitter:card"><meta content="@CodePlex" name="twitter:site"><meta content="http://dotnetzip.codeplex.com/wikipage?title=CS-Examples&amp;referringTitle=Examples&amp;ProjectName=dotnetzip" name="twitter:url"><meta content="DotNetZip Library" name="twitter:title"><meta content="DotNetZip is a FAST, FREE class library and toolset for manipulating zip files. Use VB, C&amp;#35; or  any .NET language to easily create, extract, or update zip files." name="twitter:description"><meta content="http://www.codeplex.com/favicon.ico" name="twitter:image"><meta content="CodePlex" property="og:site_name"><meta content="http://dotnetzip.codeplex.com/wikipage?title=CS-Examples&amp;referringTitle=Examples&amp;ProjectName=dotnetzip" property="og:url"><meta content="object" property="og:type"><meta content="DotNetZip Library" property="og:title"><meta content="DotNetZip is a FAST, FREE class library and toolset for manipulating zip files. Use VB, C&amp;#35; or  any .NET language to easily create, extract, or update zip files." property="og:description"><meta content="http://www.codeplex.com/favicon.ico" property="og:image">
    

    <script type="text/javascript" async="" src="./DotNetZip Library - Examples_files/a.min.js"></script></head>
    
    <body class=" NoImages">
        <script src="./DotNetZip Library - Examples_files/ScriptLoader.ashx" type="text/javascript"></script>
        <form id="aspnetForm" autocomplete="off" method="POST" enctype="multipart/form-data">
            <input name="__RequestVerificationToken" type="hidden" value="jIeCVXVgSktbfnT0xtN4Dkpx8InucVAJhDSsDR4lhaUMAY6TeaJhA6hClc2kUhP0eYWHp8UpgjT6Q6pD56xlKFr3CTqhpjV-Zma0y9E2KkHKmZDgRqBFwdYB9one_ybJ4Vn22Q2">
            
            
            
            <div style="display:none;">
                
                    <script type="text/javascript">
                        $loadScript("https://siterecruit.comscore.com/sr/codeplex/broker.js");
                    </script>

                
                
                <img id="BlankImage" style="width:0;height:0;" src="./DotNetZip Library - Examples_files/blank.png" onload="self.logoImageLoaded=true;">

                <script language="javascript" type="text/javascript">
                    var date = new Date();
                    var timezoneOffset = date.getTimezoneOffset() / 60 * -1;
                    var timezoneOffsetCookie = getCookie("TimezoneOffset");
                    var firstTimeSetTimezoneCookie = false;

                    if (timezoneOffsetCookie == null || timezoneOffsetCookie != timezoneOffset) {
                        firstTimeSetTimezoneCookie = true;
                        document.cookie = "TimezoneOffset=" + timezoneOffset + '; domain=.codeplex.com;expires=Sat, 25 Apr 2015 04:06:55 UTC';
                    }
                </script>
                
                
                    <noscript>
                        &lt;a href="http://www.omniture.com" title="Web Analytics"&gt;&lt;img src="http://msstonojstemp.112.2O7.net/b/ss/msstonojstemp/1/H.20.2--NS/0" height="1" width="1" border="0" alt="" /&gt;&lt;/a&gt;
                    </noscript>
                
            </div>
            
            <div id="header">
                <div id="header_wrap" class="row">
                    <p id="logo"><a href="http://www.codeplex.com/">Code<span class="semi">Plex</span></a><span id="tagline">Project Hosting for Open Source Software</span></p>
                    

<ul id="nav">

    <li><a href="http://dotnetzip.codeplex.com/site/register/new" id="registerLink" class="ZoomFix">Register</a></li>
    <li><a class="SignInLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2fdotnetzip.codeplex.com%2fwikipage%3ftitle%3dCS-Examples%26referringTitle%3dExamples" id="signInLink">Sign In</a></li>
  
    <li class="last"><a class="rss_site_icon" href="http://www.codeplex.com/site/feeds/rss" type="application/rss+xml" rel="Alternate" title="CodePlex Site Activity"></a></li>
</ul>
                    <input id="searchsite" name="searchsite" maxlength="500" type="text" value="" autocomplete="off" title="Search all projects" style="color: rgb(170, 170, 170); font-style: italic;"><span id="search_mag"><a id="submitSearch" name="submitSearch" class="magnify" title="Search all projects" href="http://dotnetzip.codeplex.com/wikipage?title=CS-Examples&referringTitle=Examples#"></a></span>
                    <script>
	$(document).ready(function() {
    var searchButton = $('#submitSearch'),
        searchBar = $('#searchsite');

    // Register our own handler for the search event while we wait for the SearchBox script to load.
    searchButton.bind('click.backupSearchBox', doProjectSearch);
    searchBar.bind('keypress.backupSearchBox', function(e) { if ($keyCode(e) === 13) { doProjectSearch(); return false; } });

    function cleanupSearchEvents() {
        // If the SearchBox was loaded, unregister our handlers.
        if (epx_loaded) {
            searchButton.unbind('.backupSearchBox');
            searchBar.unbind('.backupSearchBox');
        }
    }

    $loadScript('http://i4.services.social.microsoft.com/search/Widgets/SearchBox.jss?appid=1000&scopeid=1&boxId=searchsite&btnId=submitSearch&watermark=Search%20all%20projects&overrideWatermark=true&searchLocation=%2fsite%2fsearch&allowEmptySearch=true&focusOnInit=False&minimumTermLength=3', cleanupSearchEvents);
})
function doProjectSearch() {
    
    var url = '/site/search';

    //If search term is not same as watermark
    if($('#searchsite').val() != 'Search all projects')    
    {        
        url = url + '?query=' + encodeURIComponent($('#searchsite').val());
    }

    
    var callback = '';
    if (callback.length > 0 && eval('typeof ' + callback) != 'undefined')
        url += eval(callback + '()');

    window.location.href = url;
    return false;
}
</script>
                <div id="SearchFlyoutContainer" style="display: none; text-align: left; border: 1px solid buttonshadow; position: absolute; z-index: 1000; padding: 2px; background-color: rgb(255, 255, 255); color: rgb(122, 132, 142); font-family: &#39;Segoe UI&#39;, &#39;Microsoft Sans Serif&#39;, Arial, Geneva, sans-serif; font-size: 13px;"><div id="SuggestionContainer"><ul style="list-style: none; padding: 4px 2px 0px 1px; cursor: pointer; margin: 1px; white-space: nowrap;"></ul></div></div></div>
            </div>
            
            <div id="wrap">
                
    <div id="sub_heading" class="row">
        
        <div id="ProjectHeader">
            <div id="project_title_row" class="row">
                <div id="project_logo">
                    
    
    <h1><a href="http://dotnetzip.codeplex.com/"><img src="./DotNetZip Library - Examples_files/Download" alt="DotNetZip Library"></a></h1>

                </div>
            </div>
        </div>
        
        <div id="ProjectDetailsDiv">
            
        </div>
		<div class="clear"></div>
        

<ul id="page_box_links">
	<li id="homeTabCell" style="width: 75px;"><a id="homeTab" href="http://dotnetzip.codeplex.com/" class="home_active">home</a><div></div></li>
    
	<li id="sourceTabCell" style="width: 125px;"><a id="sourceTab" href="http://dotnetzip.codeplex.com/SourceControl/latest" class="box_source">source code</a><div></div></li>
    
	<li id="releasesTabCell" style="width: 117px;"><a id="releasesTab" href="http://dotnetzip.codeplex.com/releases/view/68268" class="box_downloads">downloads</a><div></div></li>
    
    <li id="documentationTabCell" style="width: 155px;"><a id="documentationTab" href="http://dotnetzip.codeplex.com/documentation" class="box_documentation">documentation</a><div></div></li>
    
	<li id="discussionTabCell" style="width: 124px;"><a id="discussionTab" href="http://dotnetzip.codeplex.com/discussions" class="box_discussions">discussions</a><div></div></li>
    
	<li id="workItemsTabCell" style="width: 82px;"><a id="workItemsTab" href="http://dotnetzip.codeplex.com/workitem/list/basic" class="box_issue">issues</a><div></div></li>
    
	<li id="peopleTabCell" style="width: 82px;"><a id="peopleTab" href="http://dotnetzip.codeplex.com/team/view" class="box_people">people</a><div></div></li>
	<li id="licenseTabCell" style="width: 82px;" class="last"><a id="licenseTab" href="http://dotnetzip.codeplex.com/license" class="box_license">license</a><div></div></li>
    
    <span class="stretch"></span>
</ul>

<script type="text/javascript">
    $(document).ready(function () {
        $('#page_box_links').applyLastClassToList();
    });
</script>
		    <div class="clear"></div>
            
    <div id="DeleteWikiPagePanel" class="modal" style="display: none;">
        <div class="row">
            <h2>Are you Sure? <a href="javascript:return false;" class="close">X</a></h2>
        </div>
        <div class="modal_info">
            By clicking Delete, all history, comments and attachments for this page will be deleted and cannot be restored.
            <div class="modal_buttons">
                <input type="button" id="CancelButton" class="cancel" value="Cancel">
                <input type="button" id="DeleteButton" class="ok" value="Delete">
            </div>
            <div class="ClearBoth"></div>
        </div>
    </div>
    
    <div id="homepage_sub_menu">
		<ul class="page_box_sublinks">
            
                <li><a id="pageInfoHyperLink" href="http://dotnetzip.codeplex.com/wiki/PageInfo?title=CS-Examples" title="Page information for CS-Examples page.">Page Info</a></li>
            
            <li class="last"><a id="changesHyperlink" href="http://dotnetzip.codeplex.com/wikipage/history" title="View change history for all pages.">Change History (all pages)</a></li>
		</ul>
        

<div>
    
    <div id="actionBar" class="action_bar">
        <ul id="actionBar_ul" class="actionBar_sublinks subtab_right" style="vertical-align: middle;">

            

                <li id="li_actionbar_followproject" data-action-id="actionbar_followproject" data-action-type="None" class="actionBar_sublinks" data-options-id="ce5a16d4-a689-480a-a128-bb703566d3b5">
                
                     
                    
                    <div class="actionBar_custom_content"></div>

                    <a href="http://dotnetzip.codeplex.com/wikipage?title=CS-Examples&referringTitle=Examples#" id="actionbar_followproject" title="Follow this project to get updates in your activity stream." class="action_bar_item_link"><img id="img_actionbar_followproject" class="action_bar_item_image" src="./DotNetZip Library - Examples_files/actionbar_follow.png" style="vertical-align: middle"> Follow (1940)</a>

                </li>

            

                <li id="li_actionbar_subscribe" data-action-id="actionbar_subscribe" data-action-type="PopUp" class="actionBar_sublinks last" data-options-id="fef17970-19ed-402b-8793-fdb9d89ca9f0">
                
                    <script class="options" defer="defer" id="fef17970-19ed-402b-8793-fdb9d89ca9f0" type="application/json">{}</script> 
                    
                    <div class="actionBar_custom_content">

<div id="rssHoverDiv" class="HoverPanel LeftHoverWidth" style="display: none">
        <ul id="3_FeedsPanel" class="RssFeedsPanel">
            <li>
                <a id="ProjectRssLink" href="http://dotnetzip.codeplex.com/project/feeds/rss" class="ArrowSmall NoUnderline">All Project Updates</a>
            </li>
            
            <li>
                <a id="DiscussionRssLink" href="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2fdotnetzip" class="ArrowSmall NoUnderline">Discussions</a>
            </li>
            
            <li>
                <a id="IssueTrackerRssLink" href="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2fdotnetzip" class="ArrowSmall NoUnderline">Issue Tracker</a>
            </li>
            
            <li>
                <a id="ReleasesRssLink" href="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2fdotnetzip" class="ArrowSmall NoUnderline">Downloads</a>
            </li>
            <li>
                <a id="ReviewsRssLink" href="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2fdotnetzip" class="ArrowSmall NoUnderline">Reviews</a>
            </li>
            
            <li>
                <a id="SourceControlRssLink" href="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2fdotnetzip" class="ArrowSmall NoUnderline">Source Code</a>
            </li>
            <li>
                <a id="WikiRssLink" href="http://dotnetzip.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2fdotnetzip" class="ArrowSmall NoUnderline">Wiki &amp; Documentation</a>
            </li>
        </ul>
</div></div>

                    <a href="http://dotnetzip.codeplex.com/wikipage?title=CS-Examples&referringTitle=Examples#" id="actionbar_subscribe" title="Subscribe to project updates in RSS feeds." class="action_bar_item_link">
                        <img id="img_actionbar_subscribe" class="action_bar_item_image" src="./DotNetZip Library - Examples_files/actionbar_subscribe.png" style="vertical-align: middle">
                        Subscribe
                    </a>

                </li>

            
        </ul>
    </div>
</div>
        <div class="clear"></div>
    </div>
    
        

    </div>
    
    
    
<div id="left_column" class="no_border">
    
        <p id="breadcrumbs" style="margin-left: 10px">
            
                <a href="http://dotnetzip.codeplex.com/">Home</a>
                
                    <img src="./DotNetZip Library - Examples_files/arrow_sm.gif" alt="Go" style="margin-top: 5px">
                
                <a href="http://dotnetzip.codeplex.com/wikipage?title=Examples">Examples</a>
                
                    <img src="./DotNetZip Library - Examples_files/arrow_sm.gif" alt="Go" style="margin-top: 5px">
                
                <a href="http://dotnetzip.codeplex.com/wikipage?title=CS-Examples">CS-Examples</a>
                
        </p>
    

    <div class="WikiHolder">

        
            <div id="WikiContent" class="WikiContent">
                <div class="wikidoc"><h1>C# Examples</h1>
This page has a few examples of how to use DotNetZip from C#. <br><br>There are working examples shipped in the DotNetZip "developers' kit" download, as Visual Studio projects.   Get the devkit on <a href="http://dotnetzip.codeplex.com/Release/ProjectReleases.aspx">the downloads page</a><br><br>See also, the Full ASP.NET Examples <a href="http://dotnetzip.codeplex.com/wikipage?title=ASPNET%20Example%201&referringTitle=CS-Examples">in C#</a>, or <a href="http://dotnetzip.codeplex.com/wikipage?title=ASPNET%20Example%202&referringTitle=CS-Examples">in VB.NET</a>.<br>
<hr>
<br><b>Create a Zip archive, add files to it, save it.</b> This is the basic programming model for the ZipFile object. Key points of interest, the <b>Using</b> clause is important.  The ZipFile object implements the IDisposable interface, indicating that users of the object need to call Dispose() on it when finished using it.  The <b>using</b> clause guarantees that the Dispose() method is called implicitly.  This will close the file pointer and allow you to move the resulting zip file, rename it, delete it, whatever.  If you do not call Dispose(), the generated zip file won't be available to use elsewhere, possibly until your application <i>exits</i>.  Also, you won't be able to delete the file, within your own application.  Normally, you would surround the code that uses DotNetZip in a try...catch, which is not shown here. <br><pre>  using (ZipFile zip = new ZipFile())
  {
    zip.AddFile("ReadMe.txt");
    zip.AddFile("7440-N49th.png");
    zip.AddFile("2008_Annual_Report.pdf");        
    zip.Save("Archive.zip");
  }
</pre><br><b>Unpack or extract items from a zip file.</b> This is probably the 2nd most common thing people do with DotNetZip. Again, note the <b>Using</b> clause. Very important.  The key method demonstrated here is the ZipEntry.Extract.  The first parameter is the Directory to which to extract. The 2nd parameter tells the Extract() method what to do when an extraction would overwrite an existing file.  The options, given by the ExtractExistingFileAction enumeration, are:  overwrite silently, throw an exception, don't overwrite (silently), or call into a delegate. This example shows how to overwrite existing files.  <br><pre>  private void MyExtract()
  {
      string zipToUnpack = "C1P3SML.zip";
      string unpackDirectory = "Extracted Files";
      using (ZipFile zip1 = ZipFile.Read(zipToUnpack))
      {
          // here, we extract every entry, but we could extract conditionally
          // based on entry name, size, date, checkbox status, etc.  
          foreach (ZipEntry e in zip1)
          {
            e.Extract(unpackDirectory, ExtractExistingFileAction.OverwriteSilently);
          }
       }
    }
</pre><br><br><b>Create a Zip archive, and write it to an output stream.</b> To save a zip file to a stream, you use the same basic programming model, but call Save() and pass a writable output stream.  <br><pre>  using (ZipFile zip = new ZipFile())
  {
    zip.AddFile("ReadMe.txt");
    zip.AddFile("7440-N49th.png");
    zip.AddFile("2008_Annual_Report.pdf");        
    zip.Save(outputStream);
  }
</pre><br><br><b>Add a set of items to a zip file.</b> This example adds entries to a zip file.  Each entry is added using the pathname in the name of the file.  Readme will appear in the root of the zip archive, the .csv file will appear in the data directory, and the .pdf will appear in the reports directory. <br><pre>  String[] filenames = { "ReadMe.txt", "c:\\data\\collection.csv", "c:\\reports\\AnnualSummary.pdf"};
  using (ZipFile zip = new ZipFile())
  {
    zip.AddFiles(filenames);
    zip.Save("Archive.zip");
  }
</pre><br><b>Add a set of items to a zip file, specifying a common directory in the zip archive.</b> This example adds entries to a zip file.  Each entry is added using the specified pathname. <br><pre>  String[] filenames = { "ReadMe.txt", "c:\\data\\collection.csv", "c:\\reports\\AnnualSummary.pdf"};
  using (ZipFile zip = new ZipFile())
  {
    zip.AddFiles(filenames, "files");
    zip.Save("Archive.zip");
  }
</pre><br><b>Add an entry with a comment.</b>  This example zips up a single file, and adds a comment to it.  The zip specification allows a comment to be added to each entry. <br><pre>  using (ZipFile zip = new ZipFile())
  {
    ZipEntry e= zip.AddFile("BusinessPlan-2a.xslx");
    e.Comment = "This is the version I worked out with Chris.";
    zip.Save("Archive.zip");
  }
</pre><br><b>Add an entry with a comment.</b>  Same as above with a more compact syntax<br><pre>  using (ZipFile zip = new ZipFile())
  {
    zip.AddFile("BusinessPlan-2a.xslx").Comment = "This is the version I worked out with Chris.";
    zip.Save("Archive.zip");
  }
</pre><br><b>Add an entry, overriding its name in the archive.</b>  This is how you can zip up a file, and rename it <i>within the archive</i> .  Upon extraction, a file will be created with the new name. <br><pre>  using (ZipFile zip1 = new ZipFile())
  {
      string newName= fileToZip + "-renamed";
      zip1.AddFile(fileToZip).FileName = newName; 
      zip1.Save(archiveName);
  }
</pre><br><b>Create a zip archive with password protection.</b>  This is the same as the first example, but we've added password protection into the mix.  The code creates a new ZipFile instance, and then specifies a password for it.  It then adds a few files into the zip archive.  The password is implicitly applied to the entries added to the ZipFile.  Upon extraction in WinZip, Windows Explorer, or some other tool, the user will have to specify the appropriate password to extract the given files.  Keep in mind that using password protection in Zip files does not protect the <i>list of files</i> contained in the Zip archive, nor the details of those files, like filename, size, date, and so on. Finally, once again notice the ever-present <b>using</b> clause.<br><pre>using (ZipFile zip = new ZipFile())
{
    zip.Password= "123456!";
    zip.AddFile("ReadMe.txt");
    zip.AddFile("7440-N49th.png");
    zip.AddFile("2005_Annual_Report.pdf");        
    zip.Save("Backup.zip");
}
</pre><br><b>Create a zip using Password protection, different passwords for each entry.</b>  Add items to a zip file, using different passwords for different items, and a comment on one of the items.<br><pre>  using (ZipFile zip = new ZipFile())
  {
    zip.AddFile("ReadMe.txt"); // no password for this entry

    zip.Password= "123456!";
    ZipEntry e = zip.AddFile("7440-N49th.png");
    e.Comment = "Map of the company headquarters."; 

    zip.Password= "!Secret1";
    zip.AddFile("2Q2008_Operations_Report.pdf");
    
    zip.Save("Backup.zip");
  }
</pre><br><b>Create a zip using Password protection, different passwords for each entry.</b>  This example uses an alternative syntax to the above. <br><pre>  using (ZipFile zip = new ZipFile())
  {
    zip.AddFile("ReadMe.txt"); // no password for this entry

    ZipEntry e = zip.AddFile("7440-N49th.png");
    e.Comment = "Map of the company headquarters."; 
    e.Password= "123456!";

    zip.AddFile("2Q2008_Operations_Report.pdf").Password = "!Secret1";
    
    zip.Save("Backup.zip");
  }
</pre><br><b>Create a Zip archive that uses WinZip-compatible AES encryption.</b>  Answering concerns that the standard password protection supported by all zip tools is weak, WinZip has extended the ZIP specification and added a way to use AES Encryption to protect entries in the Zip file.  Unlike the "PKZIP encryption" specified in the PKZIP spec, AES Encryption (<a href="http://en.wikipedia.org/wiki/Advanced_Encryption_Standard">http://en.wikipedia.org/wiki/Advanced_Encryption_Standard</a>) is a general encryption standard, usable to encrypt any sort of data, not just zip entries.  Along with being general, it is also a much stronger encryption algorithm that the PKZIP approach - harder to crack without the password.  And, AES can use variable key sizes, to vary the strength even more.  WinZip supports 128-bit and 256-bit AES Encryption.  DotNetZip supports the same file format as WinZip, therefore, creating a zip file that employs WinZip AES encryption using DotNetZip will result in zip archive that is readable by WinZip.  It all sounds very complicated but it is very easy to use with DotNetZip - all the details are taken care of.  Keep in mind though, that Zip archives that use WinZip-compatible AES encryption may not be extractable using tools other than WinZip.  For example, Windows Explorer cannot unpack a "compressed folder" that uses AES encryption.  But, if you <i>really</i> want your ZipEntries to be private, you should use AES encryption. <br><pre>  using (ZipFile zip = new ZipFile())
  {
    zip.AddFile("ReadMe.txt"); // unencrypted
    zip.Password= "123456!";
    zip.Encryption = EncryptionAlgorithm.WinZipAes256;
    zip.AddFile("7440-N49th.png");
    zip.AddFile("2008_Annual_Report.pdf");        
    zip.Save("Backup.zip");
  }
</pre><br><b>Create a zip without compression.</b>  Create a zip archive, but tell the library to not use compression when adding in the file.  This might make sense with previously-compressed files like those in .mp3 format.  A further compression of these files would gain nothing in terms of space, but would incur CPU overhead:<br><pre>  using (ZipFile zip = new ZipFile())
  {
    zip.CompressionLevel = Ionic.Zlib.CompressionLevel.None;
    zip.AddFile(@"MyMusic\Messiah-01.mp3");
    zip.Save(ZipFileToCreate);
  }
</pre><br><b>Create a zip and specify the compression level.</b>  This example creates a zip, and specifies the compression level to use for the entry in the archive.  Applications can set the compression level to adjust the balance between speed and efficiency of the compression. <br><pre>  using (ZipFile zip = new ZipFile())
  {
    zip.CompressionLevel= Ionic.Zlib.CompressionLevel.BestCompression;
    zip.AddFile("Datafeed-2008-12-20.csv");
    zip.Save(ZipFileToCreate);
  }
</pre><br><b>Create a zip containing all the files in a folder.</b>  Zip up an entire directory, recursively, and specify a comment on the zip archive when creating it: <br><pre>  using (ZipFile zip = new ZipFile())
  {
    zip.AddDirectory(@"MyDocuments\ProjectX", "ProjectX");
    zip.Comment = "This zip was created at " + System.DateTime.Now.ToString("G") ; 
    zip.Save(zipFileToCreate);
  }
</pre><br><b>Create a zip containing all the files in a folder.</b>  This is an alternative to the above.  <br><pre>  using (ZipFile zip = new ZipFile())
  {
    string[] files = Directory.GetFiles(@"MyDocuments\ProjectX");
    // add all those files to the ProjectX folder in the zip file
    zip.AddFiles(files, "ProjectX"); 
    zip.Comment = "This zip was created at " + System.DateTime.Now.ToString("G") ; 
    zip.Save(zipFileToCreate);
  }
</pre><br><b>Create a split zip containing all the files in a folder.</b>  This is like the above, except it will produce multiple files in output, each limited to 2mb in size.  The files will be named Projext.z01, Projext.z02, Projext.z03, ... Projext.zip.  The resulting zip file can be opened by WinZip, PKZip, DotNetZip, or any tool or library that supports split or "spanned" zips. <br><pre>  using (ZipFile zip = new ZipFile())
  {
    string[] files = Directory.GetFiles(@"MyDocuments\ProjectX");
    // add all those files to the ProjectX folder in the zip file
    zip.AddFiles(files, "ProjectX"); 
    zip.Comment = "This zip was created at " + System.DateTime.Now.ToString("G") ; 
    zip.MaxOutputSegmentSize = 2*1024*1024;   // 2mb
    zip.Save("ProjextX.zip");
  }
</pre><br><b>Set the timestamp on each entry as it is added.</b>  This example zips up a set of files, each protected by the same password.  Also, it overrides the last modified time for all of the files as they are stored in the zip archive:<br><pre>  using (ZipFile zip = new ZipFile())
  {
    zip1.Password = Password;
    System.DateTime Timestamp = new DateTime(DateTime.Now.Year,DateTime.Now.Month,DateTime.Now.Day,12,0,0);
    String[] filenames = System.IO.Directory.GetFiles("ProjectDocuments");
    foreach (String f in filenames)
    {
      ZipEntry e = zip.AddFile(f, "docs");
      e.LastModified = Timestamp;
    }
    zip.Comment = "This zip was created at " + System.DateTime.Now.ToString("G") ; 
    zip.Save(ZipFileToCreate);
  }
</pre><br><b>Remap directories.</b>  Zip up a set of files and directories, and re-map them into a different directory hierarchy in the zip file: <br><pre>  using (ZipFile zip = new ZipFile())
  {
    // files in the filesystem like MyDocuments\ProjectX\File1.txt , will be stored in the zip archive as  backup\File1.txt
    zip.AddDirectory(@"MyDocuments\ProjectX", "backup");
    // files in the filesystem like MyMusic\Santana\OyeComoVa.mp3, will be stored in the zip archive as  tunes\Santana\OyeComoVa.mp3
    zip.AddDirectory("MyMusic", "tunes");
    // The Readme.txt file in the filesystem will be stored in the zip archive as documents\Readme.txt
    zip.AddDirectory("Readme.txt", "documents");

    zip.Comment = "This zip was created at " + System.DateTime.Now.ToString("G") ; 
    zip.Save(ZipFileToCreate);
  }
</pre><br><b>Use wildcards.</b> Zip up a set of files using wildcards to select files from the current working directory (first available in v1.8): <br><pre>  using (ZipFile zip = new ZipFile())
  {
    zip.AddSelectedFiles("*.docx");
    zip.Save(ZipFileToCreate);
  }
</pre><br><b>Zip up using wildcards and subdirectories.</b>  Zip up a set of files using wildcards to select files from the current working directory, and recurse through subdirectories (first available in v1.8): <br><pre>  bool recurseDirectories = true;
  using (ZipFile zip = new ZipFile())
  {
    zip.AddSelectedFiles("*.docx", recurseDirectories);
    zip.Save(ZipFileToCreate);
  }
</pre><br><b>Zip up a particular folder using wildcards and subdirectories.</b>  Another variation of the above; this one specifies the directory on disk to search in.<br><pre>  bool recurseDirectories = true;
  using (ZipFile zip = new ZipFile())
  {
    zip.AddSelectedFiles("*.docx", @"C:\MyDocuments", recurseDirectories);
    zip.Save(ZipFileToCreate);
  }
</pre><br><b>Zip up using a selector string.</b>  Another variation of the above; this one zips up docx files modified since June 30th.  <br><pre>  bool recurseDirectories = true;
  string selection = "(name = *.docx) AND (mtime &gt; 2009-06-30)";
  using (ZipFile zip = new ZipFile())
  {
    zip.AddSelectedFiles(selection, @"C:\MyDocuments", recurseDirectories);
    zip.Save(ZipFileToCreate);
  }
</pre><br><br><br><b>Create a zip using content obtained from a stream.</b>  Add an entry into an archive, taking content for the entry from a stream.  Also, add a comment to the entry that was added from the stream: <br><pre>  using (ZipFile zip = new ZipFile())
  {
    ZipEntry e= zip.AddEntry("Content-From-Stream.bin", "basedirectory", StreamToRead);
    e.Comment = "The content for entry in the zip file was obtained from a stream";
    zip.AddFile("Readme.txt");
    zip.Save(zipFileToCreate);
  }
</pre><br><br><b>Update a zip: Remove an entry.</b>  Remove an entry from an existing zip file, using the string indexer:<br><pre>  using (ZipFile zip = ZipFile.Read(ExistingZipFile))
  {
    // use the indexer to remove the file from the zip archive
    zip["Readme.txt"] = null;
    zip.Comment = "This archive has been modified from its original version. Some files have been removed.";
    zip.Save();
  }
</pre><br><br><b>Update a zip: Remove an entry, alternative.</b>  Remove an entry from an existing zip file, using the RemoveEntry method.<br><pre>  using (ZipFile zip = ZipFile.Read(ExistingZipFile))
  {
    zip.RemoveEntry("Readme.txt");
    zip.Comment = "This archive has been modified from its original version. Some files have been removed.";
    zip.Save();
  }
</pre><br><br><br><b>Extract entries.</b>  Extract all files from a zip archive.  This example works if you want to extract all entries, and none of them use a password for encryption.  Within the foreach loop, you could insert a conditional to determine if you want to extract that particular entry.  You could query the timestamp on the entry, the size, the file attributes, and so on.  <br><pre>  using (ZipFile zip = ZipFile.Read(ExistingZipFile))
  {
    foreach (ZipEntry e in zip)
    {
      e.Extract(TargetDirectory);
    }
  }
</pre><br><br><b>Extract entries, an alternative.</b>  Extract all files from a zip archive.  This example works if you want to extract all entries, and none of them use a password for encryption. <br><pre>  using (ZipFile zip = ZipFile.Read(ExistingZipFile))
  {
      zip.ExtractAll(TargetDirectory);    
  }
</pre><br><br><b>Extract with overwrite.</b>  The default behavior of extraction is to NOT overwrite existing files.  If there are files that would be overwritten, DotNetZip throws an exception.   In this example, the app Extracts all files, and silently overwrites any existing files in the filesystem.  There are alternatives not shown here, to "overwrite silently":  Throw an exception, don't overwrite, or invoke an event to allow the application to decide what to do.<br><pre>  using (ZipFile zip = ZipFile.Read(ExistingZipFile))
  {
    foreach (ZipEntry e in zip)
    {
      e.Extract(TargetDirectory, ExtractExistingFileAction.OverwriteSilently);
    }
  }
</pre><br><br><b>Extract into a stream.</b>  Extract an entry from the zip archive into a previously-opened stream:<br><pre>  using (ZipFile zip = ZipFile.Read(ExistingZipFile))
  {
    ZipEntry e = zip["MyReport.doc"];
    e.Extract(OutputStream);
  }
</pre><br><br><b>Extract an encrypted entry.</b>  Extract an Entry that was encrypted with a password, into the specified base directory:<br><pre>  using (ZipFile zip = ZipFile.Read(ExistingZipFile))
  {
    ZipEntry e = zip["TaxInformation-2008.xls"];
    e.ExtractWithPassword(BaseDirectory, Password);
  }
</pre><br><br><b>Extract an Entry that was encrypted with a password, an alternative.</b><br><pre>  using (ZipFile zip = ZipFile.Read(ExistingZipFile))
  {
    ZipEntry e = zip["TaxInformation-2008.xls"];
    e.Password = Password;
    e.Extract(BaseDirectory);
  }
</pre><br><br><b>List entries in a zip.</b>  List all the entries in a zip file: <br><pre>  using (ZipFile zip = ZipFile.Read(ExistingZipFile))
  {
    foreach (ZipEntry e in zip)
    {
      if (header)
      {
        System.Console.WriteLine("Zipfile: {0}", zip.Name);
        if ((zip.Comment != null) &amp;&amp; (zip.Comment != "")) 
          System.Console.WriteLine("Comment: {0}", zip.Comment);
        System.Console.WriteLine("\n{1,-22} {2,8}  {3,5}   {4,8}  {5,3} {0}",
                                 "Filename", "Modified", "Size", "Ratio", "Packed", "pw?");
        System.Console.WriteLine(new System.String('-', 72));
        header = false;
      }
      System.Console.WriteLine("{1,-22} {2,8} {3,5:F0}%   {4,8}  {5,3} {0}",
                               e.FileName,
                               e.LastModified.ToString("yyyy-MM-dd HH:mm:ss"),
                               e.UncompressedSize,
                               e.CompressionRatio,
                               e.CompressedSize,
                               (e.UsesEncryption) ? "Y" : "N");

    }
  }
</pre><br><br><b>Input from a stream.</b>  This example reads in zip archive content from an input stream, then extracts the content for one entry to a filesysten file.  In this example, the filename "NameOfEntryInArchive.doc", refers only to the name of the entry within the zip archive.  This name is used as the index in the string indexer on the ZipFile object.  The return value is a ZipEntry.  The ZipEntry.Extract() method is then called, which extracts the named entry to a filesystem file, using the current working directory as the base.  A file by that name is created in the filesystem.  <br><pre>  using (ZipFile zip = ZipFile.Read(InputStream))
  {
    ZipEntry entry = zip["NameOfEntryInArchive.doc"];
    entry.Extract();  // create filesystem file here. 
  }
</pre><br><br><br><b>Extract to a Stream.</b>  This example reads a zip archive from a filesystem file, then extracts one of the entries in the archive into a MemoryStream, which is a Stream layered atop a byte array.  DotNetZip can extract into any writeable stream.  For example, you could extract into a FileStream, if you like, or an FtpStream, or an Http response stream. <br><pre>  using (var ms = new MemoryStream())
  {
    using (ZipFile zip = ZipFile.Read("MyArchive.zip"))
    {
      ZipEntry entry = zip["NameOfEntryInArchive.doc"];
      entry.Extract(ms);  // extract uncompressed content into a memorystream 
    }   
   // the application can now access the MemoryStream here
  }
</pre><br> <br><br><b>Obtain a Readable Stream for extraction.</b>  This example reads in a zip archive, then opens a readable stream for one of the entries in the archive.  The OpenReader() method is an alternative to the ZipEntry.Extract() overload that accepts a stream.  In the former case, the application receives a readable stream, and can obtain decompressed data for the entry from that stream.  In the latter case, the application provides a writeable stream, and DotNetZip writes decompressed data into that stream.   <br><pre>  using (ZipFile zip = ZipFile.Read("MyArchive.zip"))
  {
    ZipEntry entry = zip["NameOfEntryInArchive.doc"];
    using (var stream = entry.OpenReader()) 
    {
        var buffer = new byte[2048];
        int n;
        while ((n = stream.Read(buffer, 0, buffer.Length)) &gt; 0) 
        {
            // do something with the buffer here.
        }
    }
  }
</pre><br><br><br><b>Create a downloadable zip within ASP.NET.</b>  This example creates a zip dynamically within an ASP.NET postback method, then downloads that zipfile to the requesting browser through Response.OutputStream.  No zip archive is ever created on disk. <br><pre>public void btnGo_Click (Object sender, EventArgs e)
{
  Response.Clear();
  Response.BufferOutput= false;  // for large files
  String ReadmeText= "This is a zip file dynamically generated at " + System.DateTime.Now.ToString("G");
  string filename = System.IO.Path.GetFileName(ListOfFiles.SelectedItem.Text) + ".zip";
  Response.ContentType = "application/zip";
  Response.AddHeader("content-disposition", "filename=" + filename);
  
  using (ZipFile zip = new ZipFile()) 
  {
    zip.AddFile(ListOfFiles.SelectedItem.Text, "files");
    zip.AddEntry("Readme.txt", "", ReadmeText);
    zip.Save(Response.OutputStream);
  }
  Response.Close();
}
</pre><br><br><b>Add an entry, getting content from a string.</b>  Create a zip with a single entry, obtaining the content for that entry from a string. <br><pre>  string content = "......whatever....";  
  using (ZipFile zip = new ZipFile())
  {
    zip.AddEntry("README.txt", content);
    zip.Save("archive-2008july12.zip");
  }
</pre><br><br><b>Update a zip archive.</b>  Open an existing zip archive and modify it:  update one entry, remove a second one, and rename a third.  Then save. <br><pre>  using (ZipFile zip = ZipFile.Read("ExistingArchive.zip"))
  {
    // update
    zip.UpdateItem("Portfolio.doc"); 
    // remove
    zip["OldData.txt"].RemoveEntry();
    // rename:
    zip["Internationalization.doc"].FileName = "i18n.doc";
    // add a comment to the archive
    zip.Comment = "This zip archive was updated " + System.DateTime.ToString("G"); 
    zip.Save();
  }
</pre><br><br><br><b>Create a self-extracting archive.</b>  This example shows how to create a zip that is a self-extracting archive. <br><pre>string DirectoryPath = "c:\\Documents\\Project7";
using (ZipFile zip = new ZipFile())
{
    zip.AddDirectory(DirectoryPath, System.IO.Path.GetFileName(DirectoryPath));
    zip.Comment = "This will be embedded into a self-extracting console-based exe";
    SelfExtractorOptions options = new SelfExtractorOptions();
    options.Flavor = SelfExtractorFlavor.ConsoleApplication;
    options.DefaultExtractDirectory = "%USERPROFILE%\\ExtractHere";
    options.PostExtractCommandLine = ExeToRunAfterExtract;
    options.RemoveUnpackedFilesAfterExecute = true;
    zip.SaveSelfExtractor("archive.exe", options);
}
</pre><br><br><br><b>Create a self-extracting archive (ex 2).</b>  This one shows how to set the title of the Window that the SFX will run in.  <br><pre>var sfxFileToCreate = "DNZ1-SFX.exe";
using (var zip = new ZipFile())
{
    var filesToAdd = System.IO.Directory.GetFiles(".", "*.cs");
    zip.AddFiles(filesToAdd, "");
    var sfxOptions = new SelfExtractorSaveOptions
    {
        Flavor = SelfExtractorFlavor.WinFormsApplication,
        Quiet = false,
        Copyright = "(c) 2011 Dino P. Chiesa",
        Description = "This is a test",
        SfxExeWindowTitle = "My SFX Window title" // new feature in v1.9.1.6
    };
    zip.SaveSelfExtractor(sfxFileToCreate, sfxOptions);
}
</pre><br><br><br><b>Extract with Progress events</b>:  This can be used in a WinForms or WPF app to extract asynchronously.<br><pre>    public void ExtractFile(string zipToUnpack, string unpackDirectory)
    {
        BackgroundWorker worker = new BackgroundWorker();
        worker.WorkerReportsProgress = true;
        worker.ProgressChanged += (o, e) { .... };
        worker.DoWork += (o, e) =&gt;
        {
            using (ZipFile zip = ZipFile.Read(zipToUnpack))
            {  
                int step = (zip.Count / 100.0);
                int percentComplete = 0;
                foreach (ZipEntry file in zip)
                {
                    file.Extract(unpackDirectory, ExtractExistingFileAction.OverwriteSilently);
                    percentComplete += step;
                    worker.ReportProgress(percentComplete);
                }
            }
        };
    
        worker.RunWorkerAsync();
    }

</pre><br>
<h2>DotNetZip and LINQ</h2>
You can also select entries from a zip file using LINQ.  Browse the <a href="http://dotnetzip.codeplex.com/wikipage?title=DotNetZip-Linq-Csharp&referringTitle=CS-Examples">LINQ Examples for C#</a>.<br><br></div><div class="ClearBoth"></div>
            </div>
        
                <p>Last edited <span class="smartDate" title="8/9/2011 3:12:37 AM" localtimeticks="1312884757">Aug 9, 2011 at 3:12 AM</span> by <a id="wikiEditByLink" href="http://www.codeplex.com/site/users/view/Cheeso">Cheeso</a>, version 14</p>
            
                <div id="Comments">
                    

<script type="text/javascript">
    var commentCount = 8;
    function addComment() {
        var input = $('#Comment');
        input.val($.trim(input.val()));
        if (MvcValidation_Validate('AddComment')) {
            CodePlex.UpdateProgress.show();
            $.post('http://dotnetzip.codeplex.com/wikipage/comment', { Comment: input.val(), title: $('#WikiTitle').val() }, function(data, textStatus) {
                if (textStatus == 'success') {
                    if(commentCount++ == 0)
                        $('#wikiCommentsEmpty').empty();
                    $('#wikiComments').append(data);
                    input.val('');
                }
                CodePlex.UpdateProgress.hide();
            });
        }
    }
    function deleteComment(id) {
        if (confirm('Are you sure you want to delete this comment?')) {
            CodePlex.UpdateProgress.show();
            $.ajax({
                type: 'DELETE',
                url: 'http://dotnetzip.codeplex.com/wikipage/comment' + '/' + id,
                success: function() {
                    $('#comment' + id).empty();
                    CodePlex.UpdateProgress.hide();
                },
                error: function() { CodePlex.UpdateProgress.hide(); }
            });
        }
    }
</script>

<div id="CommentsAnchor">
    <h2>Comments</h2>
    <div id="wikiComments">
        

<div id="comment30078">
    <div class="SubText">
        <a name="C30078">
        </a><a href="http://www.codeplex.com/site/users/view/leopius">leopius</a>
        <span class="smartDate" title="4/15/2014 6:38:58 PM" localtimeticks="1397612338">Apr 15 at 6:38 PM</span>&nbsp;
        
    </div>
    when I test DotNetZip with certain zip files, I have an error "Entry uses an unsupported compression method (0x0E, LZMA)". Is there any way we can know from the ZipFile object at the outset, that it has an "unsupported compression method"<p></p>
</div>

<div id="comment28932">
    <div class="SubText">
        <a name="C28932">
        </a><a href="http://www.codeplex.com/site/users/view/balajimore">balajimore</a>
        <span class="smartDate" title="10/25/2013 8:16:37 PM" localtimeticks="1382757397">Oct 25, 2013 at 8:16 PM</span>&nbsp;
        
    </div>
    I am using Extract with overwrite function to unzip uploaded zip file in SharePoint document library using event receiver but its not working with my SharePoint project.<br><br>I have test this Extract with overwrite function in Asp.net and its worked .In SharePoint when i am trying to debug this solution its not going debug.<p></p>
</div>

<div id="comment26793">
    <div class="SubText">
        <a name="C26793">
        </a><a href="http://www.codeplex.com/site/users/view/Trisped">Trisped</a>
        <span class="smartDate" title="3/7/2013 6:14:52 AM" localtimeticks="1362665692">Mar 7, 2013 at 6:14 AM</span>&nbsp;
        
    </div>
    Example using ZipOutputStream and ZipInputStream:<br><br>public void TestZipStream()<br>{<br>	byte[] startingData = new byte[102400],<br>			endingData = new byte[102400];<br>	new Random().NextBytes(startingDat<wbr>a);<br><br>	using (MemoryStream zipStream = new MemoryStream())<br>	{<br>		//Zip data<br>		using (ZipOutputStream compressStream = new ZipOutputStream(zipStream, true))<br>		{<br>			compressStream.PutNextEntry("A<wbr>321");<br>			compressStream.Write(startingD<wbr>ata, 0, startingData.Length);<br>		}<br><br>		zipStream.Position = 0;<br><br>		//Unzip data<br>		using (ZipInputStream decompressStream = new Ionic.Zip.ZipInputStream(zipSt<wbr>ream, true))<br>		{<br>			decompressStream.GetNextEntry(<wbr>);<br>			decompressStream.Read(endingDa<wbr>ta, 0, endingData.Length);<br>		}<br>	}<br>}<p></p>
</div>

<div id="comment25296">
    <div class="SubText">
        <a name="C25296">
        </a><a href="http://www.codeplex.com/site/users/view/bmrreddy2002">bmrreddy2002</a>
        <span class="smartDate" title="10/16/2012 6:37:24 PM" localtimeticks="1350437844">Oct 16, 2012 at 6:37 PM</span>&nbsp;
        
    </div>
    I have a list file(.lst) which has the paths of files that need to be backed up. Maybe a direct path or maybe a path with * wildcard. How do I zip all the files then? thanks!<p></p>
</div>

<div id="comment23396">
    <div class="SubText">
        <a name="C23396">
        </a><a href="http://www.codeplex.com/site/users/view/xosfaere">xosfaere</a>
        <span class="smartDate" title="4/22/2012 10:05:56 PM" localtimeticks="1335157556">Apr 22, 2012 at 10:05 PM</span>&nbsp;
        
    </div>
    Thought about building a virtual file system on top of DotNetZip?<p></p>
</div>

<div id="comment23018">
    <div class="SubText">
        <a name="C23018">
        </a><a href="http://www.codeplex.com/site/users/view/dCap">dCap</a>
        <span class="smartDate" title="3/22/2012 3:42:31 PM" localtimeticks="1332456151">Mar 22, 2012 at 3:42 PM</span>&nbsp;
        
    </div>
    Thanks for your excellent utility.<br> Self-extracting archive works great (I use SelfExtractorSaveOptions), only thing which is not working well is "Quiet" option. It just do not want to overwrite the existing file.<p></p>
</div>

<div id="comment22996">
    <div class="SubText">
        <a name="C22996">
        </a><a href="http://www.codeplex.com/site/users/view/TakashiFukuda">TakashiFukuda</a>
        <span class="smartDate" title="3/21/2012 5:30:30 PM" localtimeticks="1332376230">Mar 21, 2012 at 5:30 PM</span>&nbsp;
        
    </div>
    I am trying to create an application for Japanese file names by using:<br><br>using (ZipFile zip = ZipFile.Read(fileName))<br><br>Unfortunately the unzipped file names include funnay characters. I believe the Encoding/Decoding is not set properly. How can I set "ZipFile.Read() properly for Japanese file names ?<br><br>Best regards,<br>Takashi Fukuda<br>tfukuda@documentfusion.co.jp<p></p>
</div>

<div id="comment21851">
    <div class="SubText">
        <a name="C21851">
        </a><a href="http://www.codeplex.com/site/users/view/thyake">thyake</a>
        <span class="smartDate" title="12/9/2011 8:09:46 PM" localtimeticks="1323490186">Dec 9, 2011 at 8:09 PM</span>&nbsp;
        
    </div>
    I am using "Create a self-extracting archive" example. I was unable to find SelfExtractorOptions class. Shouldn't that be SelfExtractorSaveOptions instead. I was just wondering is that a typo or am I missing something. Thanks for this cool utility.<p></p>
</div>
    </div>
    
        <div id="addComment">
            <a id="SignInToAddCommentLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2fdotnetzip.codeplex.com%2fwikipage%3ftitle%3dCS-Examples%26FocusElement%3dComment">Sign in to add a comment</a>
        </div>
    
</div>
                </div>
            
    </div>
    
    <script type="text/javascript">

        $(document).ready(function () {
            $('#deleteWikiHyperLink').click(function () {
                OpenDialog('#DeleteWikiPagePanel', true, '30em');
            });
            $('#DeleteButton').click(function () {
                OpenDialog('#DeleteWikiPagePanel', false);
                CodePlex.UpdateProgress.show();
                $.ajax({
                    type: 'DELETE',
                    url: 'http://dotnetzip.codeplex.com/wikipage?title=CS-Examples',
                    data: {title: $('#WikiTitle').val()},
                    success: function (data) {
                        CodePlex.UpdateProgress.hide();
                        window.location = data;
                    },
                    error: function (data) {
                        CodePlex.UpdateProgress.hide();
                    }
                });
            });
            $('#CancelButton').click(function () {
                OpenDialog('#DeleteWikiPagePanel', false);
            });
            
            
        });
    </script>
</div>

        
	<div id="right_sidebar">
        

<input name="" type="text" maxlength="500" id="wiki_search" title="Search Wiki and Documentation" class="EmptyTextBox"><a id="SearchButton" class="wiki_magnify" href="http://dotnetzip.codeplex.com/wikipage?title=CS-Examples&referringTitle=Examples#" title="Search Wiki and Documentation"></a>

<script type="text/javascript">

    $(function () {

        $('#wiki_search').keypress(function (e) {
            if (e.keyCode == 13) {
                wikiSearch();
                return false;
            }
        });

        $('#SearchButton').click(function () {
            wikiSearch();
            return false;
        });

        $('#wiki_search').promptBox('Search Wiki & Documentation');

    });
    function setWikiCommentTextBoxFocus() {
        $('#Comment').focus();
        return false;
    }

    function wikiSearch() {
        var $textbox = $('#wiki_search');
        if($textbox.attr('dirty') != 'true')
            return;
        var searchText = encodeURIComponent(jQuery.trim($textbox.val()));
        if(searchText != null & searchText.length > 0)
            window.location.href = 'http://dotnetzip.codeplex.com/wiki/search?tab=Home&SearchText=' + searchText;
    }

</script><a id="download_button" href="http://dotnetzip.codeplex.com/downloads/get/258012">download</a>
	<div id="current_rating">
        <table>
            <tbody><tr>
    			<th><span class="rating_header">current</span></th>
    			<td>
                    v1.9.1.8 DotNetZip - Latest Stable
    			</td>
            </tr>
            <tr>
    			<th><span class="rating_header">date</span></th>
    			<td><span class="smartDate full" title="7/11/2011 11:00:00 AM" localtimeticks="1310407200">Mon Jul 11, 2011 at 11:00 AM</span></td>
            </tr>
            <tr>
    			<th><span class="rating_header">status</span></th>
    			<td>Stable</td>
            </tr>
            <tr>
    			<th><span class="rating_header">downloads</span></th>
    			<td>297,888</td>
            </tr>
            <tr>
    			<th><span class="rating_header">rating</span></th>
                <td>
                    <span id="releaseRatingContainer" title="4.3 star rating"><span id="releaseRating_Star_0" class="RatingStar FilledRatingStar" d:rating="1" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="releaseRating_Star_1" class="RatingStar FilledRatingStar" d:rating="2" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="releaseRating_Star_2" class="RatingStar FilledRatingStar" d:rating="3" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="releaseRating_Star_3" class="RatingStar FilledRatingStar" d:rating="4" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="releaseRating_Star_4" class="RatingStar HalfRatingStar" d:rating="5" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="releaseratingName"></span><input id="releasecurrentRating" type="hidden" value="4.277778"></span>
                    <span class="right">
                        36 ratings
                    </span>
                    <br>
                    
                    <a href="http://dotnetzip.codeplex.com/releases/view/68268?RateReview=true">Review this release</a>
                    
                </td>
            </tr>
        </tbody></table>
    </div>

	<div id="recent_reviews">
	    <h2>Most Helpful Reviews</h2>
        
            <p class="review"><span id="RatingContainer" title="2 star rating"><span id="Rating_Star_0" class="RatingStar FilledRatingStar" d:rating="1" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="Rating_Star_1" class="RatingStar FilledRatingStar" d:rating="2" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="Rating_Star_2" class="RatingStar EmptyRatingStar" d:rating="3" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="Rating_Star_3" class="RatingStar EmptyRatingStar" d:rating="4" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="Rating_Star_4" class="RatingStar EmptyRatingStar" d:rating="5" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="ratingName"></span><input id="currentRating" type="hidden" value="2"></span>I have been using this library for several months. I tried to zip both large MS Access files (*.mdb), approx. 1.5 GB and medium size... <a href="http://dotnetzip.codeplex.com/releases/view/68268#ReviewsAnchor">(more)</a></p>
        
            <p class="review"><span id="RatingContainer" title="1 star rating"><span id="Rating_Star_0" class="RatingStar FilledRatingStar" d:rating="1" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="Rating_Star_1" class="RatingStar EmptyRatingStar" d:rating="2" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="Rating_Star_2" class="RatingStar EmptyRatingStar" d:rating="3" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="Rating_Star_3" class="RatingStar EmptyRatingStar" d:rating="4" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="Rating_Star_4" class="RatingStar EmptyRatingStar" d:rating="5" onclick="MvcValidation_ClearErrors(&#39;Rating&#39;);">&nbsp;</span><span id="ratingName"></span><input id="currentRating" type="hidden" value="1"></span>compression fails on some files</p>
        
        <a id="view_all_reviews" href="http://dotnetzip.codeplex.com/releases/view/68268#ReviewsAnchor">View all reviews</a>
        <div class="clear"></div>
    </div>


<div id="LoungeAdsDiv">
	<div id="Ad1" data-type="ad" data-publisher="" data-zone="ron" style="width: 300px; height: 250px; margin: 0px auto;" data-site="C-dotnetzip" data-format="300x250" data-tags="ZIP%2ccompression%2cDotNetZip%20Library%2cdotnetzip%2cLibrary%2cC%23%2cARCHIVE%2cIO%2cZipLib%2c%2a"><iframe id="dmad1" allowtransparency="false" style="z-index:10" width="300" height="250" marginwidth="0" marginheight="0" frameborder="0" scrolling="no"></iframe></div>
    <p id="adzerk_by" class="LoungeAdsBottomLinks">
        <a href="http://developermedia.com/" target="_blank">Ads by Developer Media</a>
        
    </p>
</div>
<script type="text/javascript">
    function _dmBootstrap(file) {
        var _dma = document.createElement('script');
        _dma.type = 'text/javascript';
        _dma.async = true;
        _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js'); }
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000); })();
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $('#PageActivity .Link').click(function () {
                var val = $(this).attr('d:value');
                $.post('http://dotnetzip.codeplex.com/stats/getActivity',
                    { period: val },
                    function (data) {
                        $('#PageActivity span').hide();
                        $('#PageActivity .Link').show();
                        $('#Page' + val + 'Label').show();
                        $('#Page' + val + 'Link').hide();
                        $('#pageViews').text(data.PageViews);
                        $('#visits').text(data.Visits);
                        $('#downloads').text(data.Downloads);
                    }, 'json');
                return false;
            });
        });
</script>
<div id="activity">
	<h2>activity</h2>

	<div class="clear"></div>

    <table>
	    <tbody><tr>
            <th class="t_heading">page views</th>
            <th class="t_heading">visits</th>
            <th class="t_heading">downloads</th>
	    </tr>
		<tr>
			<td><span id="pageViews">14842</span></td>
			<td><span id="visits">5815</span></td>
			<td><span id="downloads">2176</span></td>
		</tr>
    </tbody></table>

	<ul id="PageActivity"> 
		<li>Days: </li>
		<li>
		    <span id="Page7Label">7</span>
            <a id="Page7Link" href="http://dotnetzip.codeplex.com/wikipage?title=CS-Examples&referringTitle=Examples#" class="Link" style="display:none;" d:value="7">7</a>
		</li>
		<li>
		    <span id="Page30Label" style="display:none;">30</span>
            <a id="Page30Link" href="http://dotnetzip.codeplex.com/wikipage?title=CS-Examples&referringTitle=Examples#" class="Link" d:value="30">30</a>
		</li>
		<li>
		    <span id="Page-1Label" style="display:none;">All</span>
            <a id="Page-1Link" href="http://dotnetzip.codeplex.com/wikipage?title=CS-Examples&referringTitle=Examples#" class="Link" d:value="-1">All</a>
		</li>
        <li id="activity_details"><a href="http://dotnetzip.codeplex.com/stats">Details</a></li>
	</ul>

</div>

    </div>

        
                
                <div class="clear"></div>
                
                <div id="footer">
                    <div class="row">
                        <hr>
                        <ul>
                            <li>Â© 2006-2014 Microsoft</li>
                            <li><a href="http://www.codeplex.com/site/help">Get Help</a></li>
                            <li><a href="http://dotnetzip.codeplex.com/site/legal/privacy">Privacy Statement</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/terms">Terms of Use</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/conduct">Code of Conduct</a></li>
                            <li><a href="http://developermedia.com/" target="_blank">Advertise With Us</a></li>
                            <li>Version 3.6.2014.20885</li>
                        </ul>
                    </div>
                </div>
            </div>
        </form>
    

<div class="ui-dialog ui-widget ui-widget-content ui-corner-all  ui-draggable ui-resizable" tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-UpdateProgressPanel" style="display: none; z-index: 1000; outline: 0px; position: absolute;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span class="ui-dialog-title" id="ui-dialog-title-UpdateProgressPanel">&nbsp;</span><a href="http://dotnetzip.codeplex.com/wikipage?title=CS-Examples&referringTitle=Examples#" class="ui-dialog-titlebar-close ui-corner-all" role="button"><span class="ui-icon ui-icon-closethick">close</span></a></div><div id="UpdateProgressPanel" class="loading_animation ui-dialog-content ui-widget-content" style="">
                <div class="row">
                    <h2 class="anim_h2">
                        <span id="UpdateProgressText">Updating...</span>
                        <span id="animatedLoadingIconContainer">
                            <img id="animatedLoadingIcon" src="./DotNetZip Library - Examples_files/loading_animation.gif" class="anim_img">
                        </span>
                    </h2>
                </div>
            </div><div class="ui-resizable-handle ui-resizable-n"></div><div class="ui-resizable-handle ui-resizable-e"></div><div class="ui-resizable-handle ui-resizable-s"></div><div class="ui-resizable-handle ui-resizable-w"></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se ui-icon-grip-diagonal-se" style="z-index: 1001;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 1002;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 1003;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 1004;"></div></div><script src="./DotNetZip Library - Examples_files/broker-config.js"></script></body></html>